<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>ckb-next: DAEMON.md Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ckb-128.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">ckb-next
   &#160;<span id="projectnumber">v0.2.8 at branch master</span>
   </div>
   <div id="projectbrief">ckb-next driver for corsair devices</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('DAEMON_8md.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">DAEMON.md</div>  </div>
</div><!--header-->
<div class="contents">
<a href="DAEMON_8md.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;The daemon provides devices at `/dev/input/ckb*`, where * is the device number, starting at 1. Up to 9 devices may be connected at once and controlled independently. The daemon additionally provides `/dev/input/ckb0`, which stores driver information.</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;**Mac note:** The devices on OSX are located at `/var/run/ckb*` and not `/dev/input/ckb*`. So wherever you see `/dev/input` in <span class="keyword">this</span> document, replace it with `/var/run`.</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;`/dev/input/ckb0` contains the following files:</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;- `connected`: A list of all connected devices, one per line. Each line contains a device path followed by the device<span class="stringliteral">&#39;s serial number and its description.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="stringliteral">- `pid`: The process identifier of the daemon.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="stringliteral">- `version`: The daemon version.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="stringliteral">Other `ckb*` devices contain the following:</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="stringliteral">- `cmd`: Keyboard controller.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="stringliteral">- `notify0`: Keyboard notifications.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="stringliteral">- `features`: Device features.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="stringliteral">- `fwversion`: Device firmware version (not present on all devices).</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="stringliteral">- `model`: Device description/model.</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="stringliteral">- `pollrate`: Poll rate in milliseconds (not present on all devices).</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="stringliteral">- `serial`: Device serial number. `model` and `serial` will match the info found in `ckb0/connected`</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="stringliteral">Commands</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="stringliteral">--------</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="stringliteral">The `/dev/input/ckb*/cmd` nodes accept input in the form of text commands. They are normally accessible to all users on the system (see Security section). Commands should be given in the following format:</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="stringliteral">`[mode &lt;n&gt;] command1 [paramter1] [command2] [parameter2] [command3] [parameter3] ...`</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="stringliteral">In a terminal shell, you can do this like `echo mycommand &gt; /dev/input/ckb1/cmd`. Programmatically, you can open and write them as regular files. When programming, you must append a newline character and flush the output before your command(s) will actually be read.</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="stringliteral">The `mode` parameter is used to group settings. Most (but not all) settings are mode-specific; that is, changing mode 1 will not affect mode 2. By default, all commands affect the current mode. Use `mode &lt;n&gt; switch` to change the current mode.</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="stringliteral">When plugged in, all devices start in hardware-controlled mode (also known as idle mode) and will not respond to commands. Before issuing any other commands, write `active` to the command node, like `echo active &gt; /dev/input/ckb1/cmd`. To put the device back into hardware mode, issue the `idle` command.</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="stringliteral">Features</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="stringliteral">--------</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="stringliteral">The `features` node describes features supported by the device, which may not be present on all devices. The first two words in the `features` node are always `&lt;vendor&gt; &lt;model&gt;`, like `corsair k70`. After that, any of the following features may appear:</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="stringliteral">- `adjrate`: Device supports adjustable poll rate.</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="stringliteral">- `bind`: Device supports key rebinding.</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="stringliteral">- `fwupdate`: Device supports firmware updates.</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="stringliteral">- `fwversion`: Device has a detectable firmware version (stored in the `fwversion` node).</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="stringliteral">- `notify`: Device supports key notifications.</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="stringliteral">- `pollrate`: Device has a detectable poll rate (stored in the `pollrate` node).</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="stringliteral">- `rgb`: Device supports RGB lighting.</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="stringliteral">Keyboard layout</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="stringliteral">---------------</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="stringliteral">The driver has no concept of keyboard layouts; all keys are referred to by their English names regardless of the underlying hardware. This means that, for instance, in an AZERTY layout the `q` key in ckb-daemon corresponds to A on the physical keyboard. Note that on UK/european (ISO) layouts, the backslash key (beside left shift) is called `bslash_iso`, while `bslash` refers to the backslash on the US keyboard. The key next to Enter on the ISO keyboard is known as `hash`. See `src/ckb-daemon/keymap.c` for the full table of supported keys.</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="stringliteral">For technical reasons, the OSX driver may swap the `bslash_iso` and `grave` keys if the keyboard layout is not set correctly. To compensate for this, write `layout iso` or `layout ansi` to the command node.</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="stringliteral">Poll rate</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="stringliteral">---------</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="stringliteral">A device&#39;</span>s current poll rate can be read from its `pollrate` node, assuming it has one. Keyboards have a hardware <span class="keywordflow">switch</span> to control poll rate and cannot be adjusted via software. However, mice have a software-controlled poll rate. You can change it by issuing `pollrate &lt;interval&gt;` to the command node, where `interval` is the time in milliseconds. Valid poll rates are `1`, `2`, `4`, and `8`.</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;Profiles and modes</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;------------------</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;Each mode has its own independent binding and lighting setup. When the daemon starts or a keyboard is plugged in, the profile will be loaded from the hardware. By <span class="keywordflow">default</span>, all commands will update the currently selected mode. The `mode &lt;n&gt;` command may be used to change the settings <span class="keywordflow">for</span> a different mode. Up to 6 modes are available. Each keyboard has one profile, which may be given a name. Mode 1 may be saved to the device hardware, or modes 1-3 in the <span class="keywordflow">case</span> of the K95. Modes 4 through 6 are software-only. Profile management commands are as follows:</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;- `profilename &lt;name&gt;` sets the profile<span class="stringliteral">&#39;s name. The name must be written without spaces; to add a space, use `%20`.</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="stringliteral">- `name &lt;name&gt;` sets the current mode&#39;</span>s name. Use `mode &lt;n&gt; name &lt;name&gt;` to set a different mode<span class="stringliteral">&#39;s name.</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="stringliteral">- `profileid &lt;guid&gt; [&lt;modification&gt;]` sets a profile&#39;</span>s ID. The GUID must be written in registry format, like `{12345678-ABCD-EF01-2345-6789ABCDEF01}`. The optional modification number must be written with 8 hex digits, like `ABCDEF01`.</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;- `id &lt;guid&gt; [&lt;modification&gt;]` sets a mode<span class="stringliteral">&#39;s ID.</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="stringliteral">- `mode &lt;n&gt; switch` switches the keyboard to mode N. If the mode does not exist, it will be created with a blank ID, black lighting, and default bindings.</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="stringliteral">- `hwload` loads the RGB profile from the hardware. Key bindings and non-hardware RGB modes are unaffected.</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="stringliteral">- `hwsave` saves the RGB profile to the hardware.</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="stringliteral">- `erase` erases the current mode, resetting its lighting and bindings. Use `mode &lt;n&gt; erase` to erase a different mode.</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="stringliteral">- `eraseprofile` erases the entire profile, deleting its name, ID, and all of its modes.</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="stringliteral">**Examples:**</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="stringliteral">- `profilename My%20Profile mode 1 name Mode%201 mode 2 name Mode%202 mode 3 name Mode%203` will name the profile &quot;My Profile&quot; and name modes 1-3 &quot;Mode 1&quot;, &quot;Mode 2&quot;, and &quot;Mode 3&quot;.</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="stringliteral">- `eraseprofile hwload` resets the entire profile to its hardware settings.</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="stringliteral">LED commands</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="stringliteral">------------</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="stringliteral">The backlighting is controlled by the `rgb` commands.</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="stringliteral">- `rgb &lt;RRGGBB&gt;` sets the entire keyboard to the color specified by the hex constant RRGGBB.</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="stringliteral">- `rgb &lt;key&gt;:&lt;RRGGBB&gt;` sets the specified key to the specified hex color.</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="stringliteral">**Examples:**</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="stringliteral">- `rgb ffffff` makes the whole keyboard white.</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="stringliteral">- `rgb 000000` makes the whole keyboard black.</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="stringliteral">- `rgb esc:ff0000` sets the Esc key red but leaves the rest of the keyboard unchanged.</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="stringliteral">Multiple keys may be changed to one color when separated with commas, for instance:</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="stringliteral">- `rgb w,a,s,d:0000ff` sets the WASD keys to blue.</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="stringliteral">Additionally, multiple commands may be combined into one, for instance:</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="stringliteral">- `rgb ffffff esc:ff0000 w,a,s,d:0000ff` sets the Esc key red, the WASD keys blue, and the rest of the keyboard white (note the lack of a key name before `ffffff`, implying the whole keyboard is to be set).</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="stringliteral">By default, the controller runs at 30 FPS, meaning that attempts to animate the LEDs faster than that will be ignored. If you wish to change it, send the command `fps &lt;n&gt;`. The maximum frame rate is 60.</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="stringliteral">For devices running in 512-color mode, color dithering can be enabled by sending the command `dither 1`. The command `dither 0` disables dithering.</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="stringliteral">Indicators</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="stringliteral">----------</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="stringliteral">The indicator LEDs (Num Lock, Caps Lock, Scroll Lock) are controlled with the `i` commands.</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="stringliteral">- `ioff &lt;led&gt;` turns an indicator off permanently. Valid LED names are `num`, `caps`, and `scroll`.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="stringliteral">- `ion &lt;led&gt;` turns an indicator on permanently.</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="stringliteral">- `iauto &lt;led&gt;` turns an indicator off or on automatically (default behavior).</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="stringliteral">Binding keys</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="stringliteral">------------</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="stringliteral">Keys may be rebound through use of the `bind` commands. Binding is a 1-to-1 operation that translates one keypress to a different keypress regardless of circumstance.</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="stringliteral">- `bind &lt;key1&gt;:&lt;key2&gt;` remaps key1 to key2.</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="stringliteral">- `unbind &lt;key&gt;` unbinds a key, causing it to lose all function.</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="stringliteral">- `rebind &lt;key&gt;` resets a key, returning it to its default binding.</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="stringliteral">**Examples:**</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="stringliteral">- `bind g1:esc` makes G1 become an alternate Esc key (the actual Esc key is not changed).</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="stringliteral">- `bind caps:tab tab:caps` switches the functions of the Tab and Caps Lock keys.</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="stringliteral">- `unbind lwin rwin` disables both Windows keys, even without using the keyboard&#39;</span>s Windows Lock <span class="keyword">function</span>.</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;- `rebind all` resets the whole keyboard to its <span class="keywordflow">default</span> bindings.</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;Key macros</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;----------</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;Macros are a more advanced form of key binding, controlled with the `macro` command.</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;- `macro &lt;keys&gt;:&lt;command&gt;` binds a key combination to a command, where the command is a series of key presses. To combine keys, separate them with `+`; <span class="keywordflow">for</span> instance, `lctrl+a` binds a macro to (left) Ctrl+A. In the command field, enter `+&lt;key&gt;` to trigger a key down or `-&lt;key&gt;` to trigger a key up. To simulate a key press, use `+&lt;key&gt;,-&lt;key&gt;`.</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;- `macro &lt;keys&gt;:clear` clears commands associated with a key combination. Only one macro may be assigned per combination; assigning a second one will overwrite the first.</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;- `macro clear` clears all macros.</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;**Examples:**</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;- `macro g1:+lctrl,+a,-a,-lctrl` triggers a Ctrl+A when G1 is pressed.</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;- `macro g2+g3:+lalt,+f4,-f4,-lalt` triggers an Alt+F4 when G2 and G3 are pressed simultaneously.</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;Assigning a macro to a key will cause its binding to be ignored; for instance, `macro a:+b,-b` will cause A to generate a B character regardless of its binding. However, `macro lctrl+a:+b,-b` will cause A to generate a B only when Ctrl is also held down.</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;DPI and mouse settings</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;----------------------</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;DPI settings are stored in a bank. They are controlled with the `dpi` command.</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;- `dpi &lt;stage&gt;:&lt;x&gt;,&lt;y&gt;` sets the DPI for a given `stage` to `x` by `y`. Valid stages are `0` through `5`. In hardware, `1` is the first (lowest) stage and `5` is the highest. Stage `0` is used for Sniper mode.</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;- `dpi &lt;stage&gt;:&lt;xy&gt;` sets both X and Y.</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;- `dpi &lt;stage&gt;:off` disables a DPI stage.</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;- `dpisel &lt;stage&gt;` sets the current stage selection.</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;In order to change the mouse&#39;s current DPI, first update one of the stages with the value you want, then select that stage. For instance:</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;- `dpi 1:1000 dpisel 1` sets the current DPI to 1000x1000.</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;Additional mouse settings:</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;- `lift &lt;height&gt;` sets the lift height, from `1` (lowest) to `5` (highest)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;- `snap &lt;on|off&gt;` enables or disables Angle Snap.</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;Notifications</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;-------------</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;The keyboard can be configured to generate user-readable notifications on keypress events. These are controlled with the `notify` commands. In order to see events, read from `/dev/input/ckb*/notify0`. In a terminal, you can do this like `cat /dev/input/ckb1/notify0`. Programmatically, you can open it for reading like a regular file.</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;Note that the file can only reliably be read by one application: if you try to open it in two different programs, they may both fail to get data. Data will be buffered as <span class="keywordtype">long</span> as no programs are reading, so you will receive all unread notifications as soon as you open the file. If you&#39;d like to read notifications from two separate applications, send the command `notifyon &lt;n&gt;` to the keyboard you wish to receive notifications from, where N is a number between 1 and 9. If `/dev/input/ckb*/notify&lt;n&gt;` does not already exist, it will be created, and you can read notifications from there without disrupting any other program. To close a notification node, send `notifyoff &lt;n&gt;`.</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;`notify0` is always open and will not be affected by `notifyon`/`notifyoff` commands. By default, all notifications are printed to `notify0`. To print output to a different node, prefix your command with `@&lt;node&gt;`.</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;Notifications are printed with one notification per line. Commands are as follows:</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;- `notify &lt;key&gt;:on` or simply `notify &lt;key&gt;` enables notifications for a key. Each key will generate two notifications: `key +&lt;key&gt;` when the key is pressed, and `key -&lt;key&gt;` when it is released.</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;- `notify &lt;key&gt;:off` turns notifications off for a key.</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;**Examples:**</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;- `notify w a s d` sends notifications whenever W, A, S, or D is pressed.</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;- `notify g1 g2 g3 g4 g5 g6 g7 g8 g9 g10 g11 g12 g13 g14 g15 g16 g17 g18 mr m1 m2 m3 light lock` prints a notification whenever a non-standard key is pressed.</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;- `notify all:off` turns all key notifications off.</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;- `@5 notify esc` prints Esc key notifications to `notify5`.</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;**Note:** <a class="code" href="structKey.html">Key</a> notifications are _not_ affected by bindings. For instance, if you run `echo bind a:b notify a &gt; /dev/input/ckb1/cmd` and then press the A key, the notifications will read `key +a` `key -a`, despite the fact that the character printed on screen will be `b`. Likewise, unbinding a key or assigning a macro to a key does not affect the notifications.</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;Indicator notifications</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;-----------------------</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;You can also choose to receive notifications for the indicator LEDs by using the `inotify` command. For instance, `inotify caps:on` or simply `inotify caps` will print notifications whenever the Caps Lock LED is toggled. The notifications will read `i +caps` when the light is turned on and `i -caps` when it is turned off. It is also possible to toggle all indicators at once using `inotify all` or `inotify all:off`.</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;Like key notifications, indicator notifications are not affected by bindings, nor by the `ion`, `ioff`, or `iauto` commands. The notifications will reflect the state of the LEDs as seen be the event device.</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;Getting parameters</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;------------------</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;Parameters can be retrieved using the `get` command. The data will be sent out as a notification. Generally, the syntax to get the data associated with a command is `get :&lt;command&gt;` (note the colon), and the associated data will be returned in the form of `&lt;command&gt; &lt;data&gt;`. The following data may be gotten:</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;- `get :mode` returns the current mode in the form of a `switch` command. (Note: Do not use this in a line containing a `mode` command or it will return the mode that you selected, rather than the keyboard&#39;s current mode.)</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;- `get :name` returns the current mode&#39;s name in the form of `mode &lt;n&gt; name &lt;name&gt;`. To see the name of another mode, use `mode &lt;n&gt; get :name`. The name is URL-encoded; spaces are written as %20. The name may be truncated, so `name &lt;some <span class="keywordtype">long</span> <span class="keywordtype">string</span>&gt; get :name` may return something shorter than what was entered.</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;- `get :profilename` returns the profile&#39;s name, in the form of `profilename &lt;name&gt;`. As above, it is URL-encoded and may be truncated.</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;- `get :hwname` and `get :hwprofilename` return the same thing except taken from the current hardware profile instead of the in-memory profile. The output is identical but will read `hwname` instead of `name` and `hwprofilename` instead of `profilename`.</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;- `get :<span class="keywordtype">id</span>` returns the current mode&#39;s ID and modification number in the form of `mode &lt;n&gt; <span class="keywordtype">id</span> &lt;guid&gt; &lt;modification&gt;`.</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;- `get :profileid` returns the current profile&#39;s ID and modification number in the form of `profileid &lt;guid&gt; &lt;modification&gt;`.</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;- `get :hwid` and `get :hwprofileid` return the same thing except from the current hardware profile/mode. As before, the ouput will be the same but with `hwid` and `hwprofileid` instead of `<span class="keywordtype">id</span>` and `profileid`.</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;- `get :rgb` returns an `rgb` command equivalent to the current RGB state.</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;- `get :hwrgb` does the same thing, but retrieves the colors currently stored in the hardware profile. The output will say `hwrgb` instead of `rgb`.</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;- `get :dpi` returns a `dpi` command equivalent to the current DPI bank.</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;- `get :dpisel` returns a `dpisel` command for the currently-selected DPI stage.</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;- `get :lift` returns a `lift` command for the current lift height.</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;- `get :snap` returns the current angle snap status.</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;- `get :hwdpi`, `get :hwdpisel`, `get :hwlift`, and `get :hwsnap` return the same properties, but for the current hardware profile.</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;- `get :keys` and `get :i` return the current keypress status and indicator status, respectively. They will indicate all currently pressed keys and all currently active indicators, like `key +enter` and `i +num`.</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;Like `notify`, you must prefix your command with `@&lt;node&gt;` to get data printed to a node other than `notify0`.</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;Firmware updates</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;----------------</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;**WARNING:** Improper use of `fwupdate` may brick your device; use this command *at your own risk*. I accept no responsibility for broken keyboards.</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;The latest firmware versions and their URLs can be found in the `FIRMWARE` document. To update your keyboard&#39;s firmware, first extract the contents of the zip file and then issue the command `fwupdate /path/to/fw/file.bin` to the keyboard you wish to update. The path name must be absolute and must not include spaces. If it succeeded, you should see `fwupdate &lt;path&gt; ok` logged to the keyboard&#39;s notification node and then the device will disconnect and reconnect. If you see `fwupdate &lt;path&gt; invalid` it means that the firmware file was not valid for the device; more info may be available in the daemon&#39;s `stdout`. If you see `fwupdate &lt;path&gt; fail` it means that the file was valid but the update failed at a hardware level. The keyboard may disconnect/reconnect anyway or it may remain in operation.</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;When the device reconnects you should see the new firmware version in its `fwversion` node; if you see `0000` instead it means that the keyboard did not update successfully and will need another `fwupdate` command in order to function again. If the update fails repeatedly, try connecting the keyboard to a Windows PC and using the official firmware update in CUE.</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;Restart</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;-------</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;Because sometimes the communication between the daemon and the keyboard is corrupted after resuming from standby or suspend, a restart function is implemented.</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;It first calls the quit() funtion, then it calls <a class="code" href="ckb-anim_8h.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>() again with the original parameter list.</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;There are two ways to restart the daemon:</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;- send the <span class="keywordtype">string</span> &quot;restart some-description-as-one-word&quot; to the cmd-pipe (normally /dev/input/ckb1/cmd or /dev/input/ckb2/cmd, depending on what device gets which ID.</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;- send SIGUSR1 to the daemon process (as root).</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;Later on, there may be a user interface in the client for the first method.</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;Security</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;--------</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;By default, all of the `ckb*` nodes may be accessed by any user. For most single-user systems this should not present any security issues, since only one person will have access to the computer anyway. However, if you&#39;d like to restrict the users that can write to the `cmd` nodes or read from the `notify` nodes, you can specify the `--gid=&lt;group&gt;` option at start up. For instance, on most systems you could run `ckb-daemon --gid=1000` to make them accessible only by the system&#39;s primary user. `ckb-daemon` must still be run as root, regardless of which `gid` you specify. The `gid` option may be set only at startup and cannot be changed while the daemon is running.</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;The daemon additionally supports a `--nonotify` option to disable key notifications, to prevent unauthorized programs from logging key input. Note that this will interfere with some of `ckb`&#39;s abilities. It is also highly unlikely to increase security unless you are using the program in a stripped down terminal environment without Xorg. For most use cases there are many other (more likely) ways that a keylogger program could compromise your system. Nevertheless, the option is provided for the sake of paranoia. If you&#39;d like to disable key rebinding as well, launch the daemon with `--nobind`. `--nobind` implies `--nonotify`, so notifications will also be disabled. As with `--gid`, these options must be set at startup and cannot be changed while the daemon is running.</div>
<div class="ttc" id="ckb-anim_8h_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="ckb-anim_8h.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> <a href="ckb-anim_8h_source.html#l00365">ckb-anim.h:365</a></div></div>
<div class="ttc" id="structKey_html"><div class="ttname"><a href="structKey.html">Key</a></div><div class="ttdef"><b>Definition:</b> <a href="keymap_8h_source.html#l00008">keymap.h:8</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="DAEMON_8md.html">DAEMON.md</a></li>
    <li class="footer">Generated on Tue May 16 2017 20:56:47 for ckb-next by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
